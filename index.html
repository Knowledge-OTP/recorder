<html>

<head>
  <title>Recorder Demo</title>
  <style>
    .buttons {
      display: flex;
      justify-content: center;
    }

    .buttons button {
       margin-left: 10px;
    }
    
    .audio-conatiner div {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 20px;
    }
    
    .audio audio {
      margin-top: 10px;
    }
  </style>
</head>

<body>

  <div class="buttons">
    <button onclick="clickPlay()">play</button>
    <button onclick="clickStop()">stop</button>
  </div>

  <div class="audio-conatiner"></div>

  <script src="http://cdn.temasys.com.sg/skylink/skylinkjs/0.6.x/skylink.complete.js"></script>
  <script id="mp3Worker" src='vendor/mp3Worker.js' type="text/javascript"></script>
  <script src="dist/main.js"></script>


  <script>

         function createAudioDiv(blob) {
            var fragment = document.createDocumentFragment();
            var audioContainer = document.querySelector('.audio-conatiner');  
            var audioDiv = document.createElement('div');

            var span = document.createElement('span');
            span.textContent = blob.type || 'audio';

            var audio = document.createElement('audio');
            audio.setAttribute('controls', '');
            audio.controls = true;
            var audioURL = window.URL.createObjectURL(blob);
            audio.src = audioURL;

            audioDiv.appendChild(span);
            audioDiv.appendChild(audio);

            fragment.appendChild(audioDiv);

            audioContainer.appendChild(fragment);
         }
         
         var r = new RaccoonRecorder({
             fixedMedia: RaccoonRecorder.MEDIA_ENUM.audioContext
         });

         function clickPlay() {
            r.play();
         }

         r.onPermissonAccess = function() {
             console.log('on permissonAccess');  
         };

         r.onPermissonDenied = function() {
            console.log('on permissonDenied');  
         };

         r.onPlay = function() {
             console.log('on play');  
         };

         function clickStop() {
            r.stop();
         }

         r.onStop = function() {
             console.log('on stop');  
         };

         r.onMediaReady = function(blob) {
            console.log('blob', blob);

            createAudioDiv(blob);
         }

  </script>
</body>

</html>